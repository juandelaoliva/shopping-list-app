# üõí Shopping List Pro

## üìù Table of Contents

- [üá™üá∏ Espa√±ol](#-espa√±ol)
  - [Visi√≥n General (Alto Nivel)](#visi√≥n-general-alto-nivel)
  - [Detalles T√©cnicos (Bajo Nivel)](#detalles-t√©cnicos-bajo-nivel)
- [üá¨üáß English](#-english)
  - [High-Level Overview](#high-level-overview)
  - [Low-Level Technical Details](#low-level-technical-details)

---

## üá™üá∏ Espa√±ol

### Visi√≥n General (Alto Nivel)

**Shopping List Pro** es una aplicaci√≥n web moderna y completa dise√±ada para simplificar la gesti√≥n de listas de compras. Construida con una arquitectura robusta de frontend y backend, ofrece una experiencia de usuario fluida e intuitiva con funcionalidades avanzadas de gesti√≥n de productos y supermercados.

#### ‚ú® Caracter√≠sticas Principales

- **Gesti√≥n de Listas M√∫ltiples**: Crea, edita y elimina m√∫ltiples listas de compras.
- **Autenticaci√≥n de Usuarios**: Sistema de registro e inicio de sesi√≥n seguro. Cada usuario solo tiene acceso a sus propias listas.
- **Seguimiento del Presupuesto**: Asigna un presupuesto a tus listas y visualiza el gasto estimado en tiempo real.
- **Cat√°logo de Productos Avanzado**: Administra un cat√°logo completo de productos con precios, categor√≠as y supermercados.
- **Gesti√≥n de Supermercados**: Sistema completo de supermercados con colores personalizables y tags visuales.
- **P√°gina de Detalle de Producto**: Vista completa de cada producto con informaci√≥n detallada y opciones de gesti√≥n.
- **Sistema de Productos Alternativos**: Gestiona productos similares y encuentra alternativas f√°cilmente.
- **Agregar a Lista Inteligente**: Sistema intuitivo para agregar productos a listas existentes o crear nuevas.
- **Categor√≠as Personalizables**: Organiza los productos con categor√≠as codificadas por colores e iconos.
- **Estado de la Compra**: Marca los art√≠culos como comprados y observa c√≥mo la lista se completa autom√°ticamente.
- **Dise√±o Mobile-First**: Una interfaz de usuario pulida y profesional optimizada para dispositivos m√≥viles.

#### üèóÔ∏è Arquitectura

La aplicaci√≥n sigue una arquitectura cliente-servidor desacoplada:

- **Backend**: Una API RESTful construida con **Node.js** y **Express**. Se encarga de toda la l√≥gica de negocio, la interacci√≥n con la base de datos y la seguridad, utilizando **JWT (JSON Web Tokens)** para la gesti√≥n de sesiones y **bcrypt** para el almacenamiento seguro de contrase√±as.
- **Frontend**: Una Aplicaci√≥n de P√°gina √önica (SPA) construida con **React** y **TypeScript**. Proporciona una interfaz de usuario interactiva y din√°mica con navegaci√≥n fluida.
- **Base de Datos**: **PostgreSQL** se utiliza para la persistencia de datos, almacenando listas, productos, categor√≠as, supermercados y art√≠culos con integridad referencial completa.
- **Contenerizaci√≥n**: **Docker** y **Docker Compose** se utilizan para encapsular y orquestar los servicios de frontend, backend y base de datos, con configuraciones separadas para desarrollo y producci√≥n.

#### üÜï Nuevas Funcionalidades Destacadas

##### üì± **P√°gina de Detalle de Producto**
- **Vista completa del producto** con toda la informaci√≥n relevante
- **Informaci√≥n detallada**: categor√≠a (con color), supermercado (con color), precio estimado, unidad, fecha de creaci√≥n
- **Productos alternativos**: Lista de productos similares con navegaci√≥n directa
- **Acciones disponibles**: Editar, eliminar, agregar a lista
- **Navegaci√≥n intuitiva**: Accesible desde el cat√°logo de productos

##### üõí **Sistema "Agregar a Lista" Avanzado**
- **Modal inteligente** que se adapta al contexto:
  - **Con listas existentes**: Muestra todas las listas disponibles (completas o activas)
  - **Sin listas**: Mensaje explicativo con navegaci√≥n directa para crear una nueva
- **Informaci√≥n completa de listas**: nombre, descripci√≥n, n√∫mero de productos, estado
- **Navegaci√≥n autom√°tica**: Al crear nueva lista, abre autom√°ticamente el modal de creaci√≥n
- **Agregado inteligente**: Cantidad por defecto y datos del producto pre-cargados

##### ‚úèÔ∏è **Gesti√≥n Completa de Productos**
- **Edici√≥n in-situ**: Modal de edici√≥n completo desde la p√°gina de detalle
- **Gesti√≥n de alternativas**: Agregar y quitar productos alternativos f√°cilmente
- **Eliminaci√≥n segura**: Confirmaci√≥n y manejo de integridad referencial
- **Validaciones robustas**: Manejo de errores y retroalimentaci√≥n clara

##### üè™ **Sistema de Supermercados Mejorado**
- **Colores personalizables**: Cada supermercado puede tener su color distintivo
- **Tags consistentes**: Colores aplicados autom√°ticamente en toda la aplicaci√≥n
- **Integraci√≥n visual**: Los colores se muestran en productos, listas y alternativas
- **Manejo robusto**: Sistema de colores por defecto para evitar errores

---

### Detalles T√©cnicos (Bajo Nivel)

#### üõ†Ô∏è Stack Tecnol√≥gico

- **Backend**: Node.js, Express, PostgreSQL (con `pg`), Helmet (seguridad), CORS, Express Rate Limit, bcrypt, jsonwebtoken.
- **Frontend**: React, TypeScript, Tailwind CSS, Lucide React (iconos).
- **Entorno**: Docker, Docker Compose (configuraciones para desarrollo y producci√≥n).

#### üöÄ C√≥mo Empezar

##### üê≥ **Desarrollo con Docker (Recomendado)**

1. **Clonar el repositorio**:
```bash
git clone <URL_DEL_REPOSITORIO>
cd showcaseAntonio
```

2. **Configuraci√≥n de desarrollo**:
```bash
# Usar el entorno de desarrollo optimizado
docker-compose -f docker-compose.dev.yml up --build
```

3. **Configuraci√≥n de producci√≥n**:
```bash
# Para producci√≥n usar el compose principal
docker-compose up --build
```

4. **Acceder a la aplicaci√≥n**:
   - **Frontend**: `http://localhost:3000`
   - **Backend API**: `http://localhost:5001`

##### üíª **Desarrollo Local (Alternativa)**

1. **Configurar variables de entorno**:
   El backend requiere una URL de conexi√≥n a la base de datos. Por defecto, `docker-compose.yml` la configura.

2. **Instalar dependencias**:
   - **Backend**: `cd backend && npm install`
   - **Frontend**: `cd frontend && npm install`

3. **Iniciar servicios manualmente**:
   ```bash
   # Terminal 1 - Base de datos
   docker run -p 5432:5432 -e POSTGRES_DB=shopping_app -e POSTGRES_USER=postgres -e POSTGRES_PASSWORD=password postgres:13
   
   # Terminal 2 - Backend
   cd backend && npm start
   
   # Terminal 3 - Frontend  
   cd frontend && npm start
   ```

#### üë§ **Usuario de Demostraci√≥n**

La aplicaci√≥n se inicializa con un usuario de prueba para exploraci√≥n inmediata:
- **Email**: `demo@example.com`
- **Contrase√±a**: `password123`

#### üîê Seguridad: Almacenamiento de Contrase√±as

La seguridad es una prioridad. En esta aplicaci√≥n, **las contrase√±as nunca se guardan en texto plano**. Utilizamos un m√©todo robusto y est√°ndar de la industria llamado **hashing de contrase√±as** a trav√©s de la librer√≠a `bcrypt`.

**¬øC√≥mo funciona?**
1. Cuando un usuario se registra, su contrase√±a no se guarda directamente. En su lugar, se pasa por un algoritmo matem√°tico complejo (`bcrypt`) que la convierte en una cadena de caracteres √∫nica y de longitud fija llamada "hash".
2. Este proceso es **unidireccional**: es computacionalmente inviable revertir el hash para obtener la contrase√±a original.
3. Cuando el usuario inicia sesi√≥n, la contrase√±a que introduce se vuelve a "hashear" y el resultado se compara con el hash que est√° guardado en la base de datos. Si ambos hashes coinciden, el acceso es concedido.

Esto garantiza que, incluso en el hipot√©tico caso de un acceso no autorizado a la base de datos, las contrase√±as de los usuarios permanecer√≠an seguras y protegidas.

#### üóÉÔ∏è Esquema de la Base de Datos (PostgreSQL)

La base de datos consta de seis tablas principales con integridad referencial completa:

1. `users`: Almacena las credenciales seguras de los usuarios.
   - `id`: SERIAL PRIMARY KEY
   - `email`: VARCHAR(255) UNIQUE
   - `password_hash`: VARCHAR(255) (El hash de la contrase√±a, no la contrase√±a)
   - `created_at`: TIMESTAMP

2. `categories`: Almacena las categor√≠as de los productos.
   - `id`: SERIAL PRIMARY KEY
   - `name`: VARCHAR(100)
   - `color`: VARCHAR(7)
   - `icon`: VARCHAR(50)

3. **`supermarkets`**: Almacena informaci√≥n de supermercados *(Nueva funcionalidad)*
   - `id`: SERIAL PRIMARY KEY
   - `name`: VARCHAR(100)
   - `color`: VARCHAR(7) DEFAULT '#6366F1' *(Color personalizable)*
   - `created_at`: TIMESTAMP

4. `products`: Cat√°logo de productos reutilizables.
   - `id`: SERIAL PRIMARY KEY
   - `name`: VARCHAR(200)
   - `category_id`: INTEGER (FK a `categories.id`)
   - **`supermarket_id`**: INTEGER (FK a `supermarkets.id`) *(Nuevo campo)*
   - `estimated_price`: DECIMAL(10,2)
   - `unit`: VARCHAR(20)
   - `created_at`: TIMESTAMP

5. **`product_alternatives`**: Relaciones entre productos alternativos *(Nueva tabla)*
   - `id`: SERIAL PRIMARY KEY
   - `product_id`: INTEGER (FK a `products.id`)
   - `alternative_product_id`: INTEGER (FK a `products.id`)
   - `created_at`: TIMESTAMP

6. `shopping_lists`: Las listas de compra, vinculadas a un usuario.
   - `id`: SERIAL PRIMARY KEY
   - `user_id`: INTEGER (FK a `users.id`)
   - `name`: VARCHAR(200)
   - `description`: TEXT
   - `total_budget`: DECIMAL(10,2)
   - `is_completed`: BOOLEAN
   - `completed_at`: TIMESTAMP
   - `created_at`: TIMESTAMP

7. `list_items`: Los art√≠culos dentro de cada lista.
   - `id`: SERIAL PRIMARY KEY
   - `shopping_list_id`: INTEGER (FK a `shopping_lists.id`)
   - `product_id`: INTEGER (FK a `products.id`, **NULLABLE para integridad**)
   - `custom_product_name`: VARCHAR(200) (si no se usa un producto del cat√°logo)
   - `quantity`: INTEGER
   - `unit`: VARCHAR(20)
   - `estimated_price`: DECIMAL(10,2)
   - `is_purchased`: BOOLEAN
   - `created_at`: TIMESTAMP

#### üåê API Endpoints del Backend

La API base se encuentra en `/api`.

**Autenticaci√≥n**
- `POST /auth/register`: Registra un nuevo usuario.
- `POST /auth/login`: Inicia sesi√≥n y devuelve un token JWT.

**Categor√≠as**
- `GET /categories`: Obtiene todas las categor√≠as.

**Supermercados** *(Nueva funcionalidad)*
- `GET /supermarkets`: Obtiene todos los supermercados con colores.
- `GET /supermarkets/:id`: Obtiene un supermercado espec√≠fico.
- `POST /supermarkets`: Crea un nuevo supermercado.
- `PUT /supermarkets/:id`: Actualiza un supermercado (incluyendo color).
- `DELETE /supermarkets/:id`: Elimina un supermercado.

**Productos** *(Funcionalidad ampliada)*
- `GET /products`: Obtiene todos los productos con informaci√≥n de supermercado y colores. Admite queries `?category_id=` y `?search=`.
- **`GET /products/:id`**: Obtiene un producto espec√≠fico con detalles completos *(Nuevo)*
- `POST /products`: Crea un nuevo producto.
- **`PUT /products/:id`**: Actualiza un producto completo *(Nuevo)*
- **`DELETE /products/:id`**: Elimina un producto con integridad referencial *(Nuevo)*
- **`GET /products/:id/alternatives`**: Obtiene productos alternativos *(Nuevo)*
- **`POST /products/:id/alternatives`**: Agrega un producto alternativo *(Nuevo)*
- **`DELETE /products/:id/alternatives/:altId`**: Quita un producto alternativo *(Nuevo)*

**Listas de Compra**
- `GET /shopping-lists`: Obtiene todas las listas con datos agregados.
- `GET /shopping-lists/:id`: Obtiene una lista espec√≠fica con todos sus art√≠culos (incluyendo colores de supermercado).
- `POST /shopping-lists`: Crea una nueva lista.
- `PUT /shopping-lists/:id`: Actualiza una lista.
- `DELETE /shopping-lists/:id`: Elimina una lista.

**Art√≠culos de la Lista**
- `POST /shopping-lists/:listId/items`: A√±ade un art√≠culo a una lista.
- `PUT /shopping-lists/:listId/items/:itemId`: Actualiza un art√≠culo de una lista.
- `DELETE /shopping-lists/:listId/items/:itemId`: Elimina un art√≠culo de una lista.

#### ‚öõÔ∏è Arquitectura del Frontend

La aplicaci√≥n ha evolucionado hacia una estructura m√°s modular y organizada:

##### üìÅ **Estructura Actual de Archivos**

```
frontend/src/
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ ColorPicker.tsx              # Selector de colores y utilidades
‚îÇ   ‚îú‚îÄ‚îÄ Layout/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BottomNavigation.tsx     # Navegaci√≥n inferior
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Icons.ts                 # Iconos centralizados
‚îÇ   ‚îî‚îÄ‚îÄ ShoppingList/
‚îÇ       ‚îú‚îÄ‚îÄ ListItem.tsx             # Componente de item de lista
‚îÇ       ‚îî‚îÄ‚îÄ ShoppingListCard.tsx     # Tarjeta de lista
‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îú‚îÄ‚îÄ SupermarketsPage.tsx         # Gesti√≥n de supermercados
‚îÇ   ‚îî‚îÄ‚îÄ ProductDetailScreen.tsx      # P√°gina de detalle de producto *(Nueva)*
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îî‚îÄ‚îÄ api.ts                       # Servicios API centralizados
‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îî‚îÄ‚îÄ index.ts                     # Definiciones TypeScript
‚îú‚îÄ‚îÄ index.tsx                        # Aplicaci√≥n principal y componentes
‚îî‚îÄ‚îÄ index.css                        # Estilos globales
```

##### üéØ **Componentes Principales**

**P√°ginas:**
- **`ProductDetailScreen.tsx`** *(Nuevo)*: Vista completa de producto con edici√≥n, eliminaci√≥n y agregar a lista
- **`SupermarketsPage.tsx`**: Gesti√≥n completa de supermercados con colores
- **`HomeScreen`** (en index.tsx): Dashboard principal con listas
- **`ProductsScreen`** (en index.tsx): Cat√°logo de productos con navegaci√≥n a detalle
- **`ListScreen`** (en index.tsx): Vista detallada de una lista espec√≠fica

**Componentes de UI:**
- **`ColorPicker.tsx`**: Selector de colores reutilizable con utilidades de contraste
- **`BottomNavigation.tsx`**: Navegaci√≥n principal de la aplicaci√≥n
- **`ListItem.tsx`**: Componente de item con soporte para colores de supermercado
- **`ShoppingListCard.tsx`**: Tarjeta de lista con informaci√≥n completa

**Modales:** *(Integrados en componentes principales)*
- **`AddToListModal`**: Modal inteligente para agregar productos a listas
- **`EditProductModal`**: Modal completo de edici√≥n de productos
- **`CreateListModal`**: Modal de creaci√≥n de listas
- **`DeleteConfirmModal`**: Confirmaciones de eliminaci√≥n

##### üîÑ **Sistema de Navegaci√≥n Avanzado**

```typescript
// Funci√≥n de navegaci√≥n extendida
navigate(view: string, listId?: number, productId?: number, openModal?: string)

// Ejemplos de uso:
navigate('home')                           // Ir al home
navigate('product-detail', undefined, 123) // Ver detalle del producto 123  
navigate('home', undefined, undefined, 'newList') // Ir al home y abrir modal de crear lista
```

**Caracter√≠sticas:**
- **Sistema de eventos customizados** para comunicaci√≥n entre componentes
- **Navegaci√≥n autom√°tica** con apertura de modales
- **Estado de navegaci√≥n centralizado** en el componente principal
- **Rutas din√°micas** basadas en estado interno

##### üé® **Sistema de Colores Unificado**

```typescript
// Funci√≥n helper para tags de supermercado consistentes
createSupermarketBadge(name: string, color?: string | null, size: 'xs' | 'sm' = 'sm')

// Funci√≥n de contraste autom√°tico  
getContrastTextColor(backgroundColor: string | null | undefined): string
```

**Aplicaci√≥n:**
- Tags de supermercado en todos los productos
- Badges de categor√≠a con colores autom√°ticos
- Indicadores visuales consistentes en toda la aplicaci√≥n
- Manejo robusto de valores null/undefined 

---

## üá¨üáß English

### High-Level Overview

**Shopping List Pro** is a modern, full-featured web application designed to simplify shopping list management. Built with a robust frontend and backend architecture, it offers a smooth and intuitive user experience with advanced product and supermarket management features.

#### ‚ú® Key Features

- **Multiple List Management**: Create, edit, and delete multiple shopping lists.
- **User Authentication**: Secure registration and login system. Each user only has access to their own lists.
- **Budget Tracking**: Assign a budget to your lists and see the estimated real-time spending.
- **Advanced Product Catalog**: Manage a comprehensive catalog of products with prices, categories, and supermarkets.
- **Supermarket Management**: Complete supermarket system with customizable colors and visual tags.
- **Product Detail Page**: Complete view of each product with detailed information and management options.
- **Alternative Products System**: Manage similar products and find alternatives easily.
- **Smart Add to List**: Intuitive system to add products to existing lists or create new ones.
- **Customizable Categories**: Organize products with color-coded and icon-based categories.
- **Purchase Status**: Mark items as purchased and watch the list auto-complete.
- **Mobile-First Design**: A polished and professional user interface optimized for mobile devices.

#### üèóÔ∏è Architecture

The application follows a decoupled client-server architecture:

- **Backend**: A RESTful API built with **Node.js** and **Express**. It handles all business logic, database interaction, and security, using **JWT (JSON Web Tokens)** for session management and **bcrypt** for secure password storage.
- **Frontend**: A Single Page Application (SPA) built with **React** and **TypeScript**. It provides an interactive and dynamic user interface with smooth navigation.
- **Database**: **PostgreSQL** is used for data persistence, storing lists, products, categories, supermarkets, and items with complete referential integrity.
- **Containerization**: **Docker** and **Docker Compose** are used to encapsulate and orchestrate the frontend, backend, and database services, with separate configurations for development and production.

#### üÜï New Featured Functionalities

##### üì± **Product Detail Page**
- **Complete product view** with all relevant information
- **Detailed information**: category (with color), supermarket (with color), estimated price, unit, creation date
- **Alternative products**: List of similar products with direct navigation
- **Available actions**: Edit, delete, add to list
- **Intuitive navigation**: Accessible from the product catalog

##### üõí **Advanced "Add to List" System**
- **Smart modal** that adapts to context:
  - **With existing lists**: Shows all available lists (complete or active)
  - **Without lists**: Explanatory message with direct navigation to create a new one
- **Complete list information**: name, description, number of products, status
- **Automatic navigation**: When creating a new list, automatically opens the creation modal
- **Smart adding**: Default quantity and pre-loaded product data

##### ‚úèÔ∏è **Complete Product Management**
- **In-situ editing**: Complete editing modal from the detail page
- **Alternative management**: Easily add and remove alternative products
- **Safe deletion**: Confirmation and referential integrity handling
- **Robust validations**: Error handling and clear feedback

##### üè™ **Enhanced Supermarket System**
- **Customizable colors**: Each supermarket can have its distinctive color
- **Consistent tags**: Colors automatically applied throughout the application
- **Visual integration**: Colors shown in products, lists, and alternatives
- **Robust handling**: Default color system to prevent errors

---

### Low-Level Technical Details

#### üõ†Ô∏è Tech Stack

- **Backend**: Node.js, Express, PostgreSQL (with `pg`), Helmet (security), CORS, Express Rate Limit, bcrypt, jsonwebtoken.
- **Frontend**: React, TypeScript, Tailwind CSS, Lucide React (icons).
- **Environment**: Docker, Docker Compose (configurations for development and production).

#### üöÄ Getting Started

##### üê≥ **Development with Docker (Recommended)**

1. **Clone the repository**:
```bash
git clone <REPOSITORY_URL>
cd showcaseAntonio
```

2. **Development setup**:
```bash
# Use the optimized development environment
docker-compose -f docker-compose.dev.yml up --build
```

3. **Production setup**:
```bash
# For production use the main compose
docker-compose up --build
```

4. **Access the application**:
   - **Frontend**: `http://localhost:3000`
   - **Backend API**: `http://localhost:5001`

##### üíª **Local Development (Alternative)**

1. **Set up environment variables**:
   The backend requires a database connection URL. By default, `docker-compose.yml` handles this.

2. **Install dependencies**:
   - **Backend**: `cd backend && npm install`
   - **Frontend**: `cd frontend && npm install`

3. **Start services manually**:
   ```bash
   # Terminal 1 - Database
   docker run -p 5432:5432 -e POSTGRES_DB=shopping_app -e POSTGRES_USER=postgres -e POSTGRES_PASSWORD=password postgres:13
   
   # Terminal 2 - Backend
   cd backend && npm start
   
   # Terminal 3 - Frontend  
   cd frontend && npm start
   ```

#### üë§ **Demo User**

The application is seeded with a test user for immediate exploration:
- **Email**: `demo@example.com`
- **Password**: `password123`

#### üîê Security: Password Storage

Security is a top priority. In this application, **passwords are never stored in plain text**. We use a robust, industry-standard method called **password hashing** via the `bcrypt` library.

**How does it work?**
1. When a user signs up, their password is not saved directly. Instead, it's passed through a complex mathematical algorithm (`bcrypt`) that converts it into a unique, fixed-length string of characters called a "hash".
2. This process is **one-way**: it is computationally infeasible to reverse the hash to get the original password.
3. When the user logs in, the password they enter is hashed again, and the result is compared to the hash stored in the database. If both hashes match, access is granted.

This ensures that even in the unlikely event of a database breach, users' passwords would remain safe and protected.

#### üóÉÔ∏è Database Schema (PostgreSQL)

The database consists of six main tables with complete referential integrity:

1. `users`: Stores secure user credentials.
   - `id`: SERIAL PRIMARY KEY
   - `email`: VARCHAR(255) UNIQUE
   - `password_hash`: VARCHAR(255) (The password hash, not the password itself)
   - `created_at`: TIMESTAMP

2. `categories`: Stores product categories.
   - `id`: SERIAL PRIMARY KEY
   - `name`: VARCHAR(100)
   - `color`: VARCHAR(7)
   - `icon`: VARCHAR(50)

3. **`supermarkets`**: Stores supermarket information *(New functionality)*
   - `id`: SERIAL PRIMARY KEY
   - `name`: VARCHAR(100)
   - `color`: VARCHAR(7) DEFAULT '#6366F1' *(Customizable color)*
   - `created_at`: TIMESTAMP

4. `products`: Catalog of reusable products.
   - `id`: SERIAL PRIMARY KEY
   - `name`: VARCHAR(200)
   - `category_id`: INTEGER (FK to `categories.id`)
   - **`supermarket_id`**: INTEGER (FK to `supermarkets.id`) *(New field)*
   - `estimated_price`: DECIMAL(10,2)
   - `unit`: VARCHAR(20)
   - `created_at`: TIMESTAMP

5. **`product_alternatives`**: Relationships between alternative products *(New table)*
   - `id`: SERIAL PRIMARY KEY
   - `product_id`: INTEGER (FK to `products.id`)
   - `alternative_product_id`: INTEGER (FK to `products.id`)
   - `created_at`: TIMESTAMP

6. `shopping_lists`: The shopping lists, linked to a user.
   - `id`: SERIAL PRIMARY KEY
   - `user_id`: INTEGER (FK to `users.id`)
   - `name`: VARCHAR(200)
   - `description`: TEXT
   - `total_budget`: DECIMAL(10,2)
   - `is_completed`: BOOLEAN
   - `completed_at`: TIMESTAMP
   - `created_at`: TIMESTAMP

7. `list_items`: The items within each list.
   - `id`: SERIAL PRIMARY KEY
   - `shopping_list_id`: INTEGER (FK to `shopping_lists.id`)
   - `product_id`: INTEGER (FK to `products.id`, **NULLABLE for integrity**)
   - `custom_product_name`: VARCHAR(200) (if not using a catalog product)
   - `quantity`: INTEGER
   - `unit`: VARCHAR(20)
   - `estimated_price`: DECIMAL(10,2)
   - `is_purchased`: BOOLEAN
   - `created_at`: TIMESTAMP

#### üåê Backend API Endpoints

The base API is located at `/api`.

**Authentication**
- `POST /auth/register`: Registers a new user.
- `POST /auth/login`: Logs in a user and returns a JWT.

**Categories**
- `GET /categories`: Fetches all categories.

**Supermarkets** *(New functionality)*
- `GET /supermarkets`: Fetches all supermarkets with colors.
- `GET /supermarkets/:id`: Fetches a specific supermarket.
- `POST /supermarkets`: Creates a new supermarket.
- `PUT /supermarkets/:id`: Updates a supermarket (including color).
- `DELETE /supermarkets/:id`: Deletes a supermarket.

**Products** *(Expanded functionality)*
- `GET /products`: Fetches all products with supermarket information and colors. Supports `?category_id=` and `?search=` queries.
- **`GET /products/:id`**: Fetches a specific product with complete details *(New)*
- `POST /products`: Creates a new product.
- **`PUT /products/:id`**: Updates a complete product *(New)*
- **`DELETE /products/:id`**: Deletes a product with referential integrity *(New)*
- **`GET /products/:id/alternatives`**: Fetches alternative products *(New)*
- **`POST /products/:id/alternatives`**: Adds an alternative product *(New)*
- **`DELETE /products/:id/alternatives/:altId`**: Removes an alternative product *(New)*

**Shopping Lists**
- `GET /shopping-lists`: Fetches all lists with aggregated data.
- `GET /shopping-lists/:id`: Fetches a specific list with all its items (including supermarket colors).
- `POST /shopping-lists`: Creates a new list.
- `PUT /shopping-lists/:id`: Updates a list.
- `DELETE /shopping-lists/:id`: Deletes a list.

**List Items**
- `POST /shopping-lists/:listId/items`: Adds an item to a list.
- `PUT /shopping-lists/:listId/items/:itemId`: Updates an item in a list.
- `DELETE /shopping-lists/:listId/items/:itemId`: Deletes an item from a list.

#### ‚öõÔ∏è Frontend Architecture

The application has evolved towards a more modular and organized structure:

##### üìÅ **Current File Structure**

```
frontend/src/
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ ColorPicker.tsx              # Color picker and utilities
‚îÇ   ‚îú‚îÄ‚îÄ Layout/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BottomNavigation.tsx     # Bottom navigation
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Icons.ts                 # Centralized icons
‚îÇ   ‚îî‚îÄ‚îÄ ShoppingList/
‚îÇ       ‚îú‚îÄ‚îÄ ListItem.tsx             # List item component
‚îÇ       ‚îî‚îÄ‚îÄ ShoppingListCard.tsx     # List card
‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îú‚îÄ‚îÄ SupermarketsPage.tsx         # Supermarket management
‚îÇ   ‚îî‚îÄ‚îÄ ProductDetailScreen.tsx      # Product detail page *(New)*
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îî‚îÄ‚îÄ api.ts                       # Centralized API services
‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îî‚îÄ‚îÄ index.ts                     # TypeScript definitions
‚îú‚îÄ‚îÄ index.tsx                        # Main application and components
‚îî‚îÄ‚îÄ index.css                        # Global styles
```

##### üéØ **Main Components**

**Pages:**
- **`ProductDetailScreen.tsx`** *(New)*: Complete product view with editing, deletion, and add to list
- **`SupermarketsPage.tsx`**: Complete supermarket management with colors
- **`HomeScreen`** (in index.tsx): Main dashboard with lists
- **`ProductsScreen`** (in index.tsx): Product catalog with navigation to detail
- **`ListScreen`** (in index.tsx): Detailed view of a specific list

**UI Components:**
- **`ColorPicker.tsx`**: Reusable color picker with contrast utilities
- **`BottomNavigation.tsx`**: Main application navigation
- **`ListItem.tsx`**: Item component with supermarket color support
- **`ShoppingListCard.tsx`**: List card with complete information

**Modals:** *(Integrated in main components)*
- **`AddToListModal`**: Smart modal for adding products to lists
- **`EditProductModal`**: Complete product editing modal
- **`CreateListModal`**: List creation modal
- **`DeleteConfirmModal`**: Deletion confirmations

##### üîÑ **Advanced Navigation System**

```typescript
// Extended navigation function
navigate(view: string, listId?: number, productId?: number, openModal?: string)

// Usage examples:
navigate('home')                           // Go to home
navigate('product-detail', undefined, 123) // View product 123 detail  
navigate('home', undefined, undefined, 'newList') // Go to home and open create list modal
```

**Features:**
- **Custom event system** for component communication
- **Automatic navigation** with modal opening
- **Centralized navigation state** in main component
- **Dynamic routes** based on internal state

##### üé® **Unified Color System**

```typescript
// Helper function for consistent supermarket tags
createSupermarketBadge(name: string, color?: string | null, size: 'xs' | 'sm' = 'sm')

// Automatic contrast function  
getContrastTextColor(backgroundColor: string | null | undefined): string
```

**Application:**
- Supermarket tags in all products
- Category badges with automatic colors
- Consistent visual indicators throughout the application
- Robust handling of null/undefined values

---

## üöÄ Recent Updates & Improvements

### ‚ú® **Latest Features Added**

1. **üîß System Fixes**
   - Fixed `Cannot read properties of undefined (reading 'replace')` error in supermarkets page
   - Added `color` column to `supermarkets` table with proper migration
   - Enhanced `getContrastTextColor` function for robust null/undefined handling

2. **üé® UI/UX Enhancements**
   - Simplified SupermarketCard design (removed explicit color badge, border color only)
   - Unified supermarket tags with consistent colors across the entire application
   - Improved hover effects and visual feedback

3. **üì± Major New Functionality**
   - **Complete ProductDetailScreen**: New dedicated page for product management
   - **Advanced product editing**: Full modal with alternative product management
   - **Safe product deletion**: Confirmation dialogs with referential integrity
   - **Smart "Add to List" system**: Intelligent modal with auto-navigation

4. **üîå Backend Improvements**
   - New API routes: `GET/PUT/DELETE /api/products/:id`
   - Enhanced queries with supermarket color information
   - Referential integrity for safe product deletion
   - Alternative products relationship management

5. **üõ†Ô∏è Technical Enhancements**
   - Automatic navigation system with custom events
   - Updated TypeScript interfaces with new fields
   - Development Docker configurations for optimized workflow
   - Improved error handling and validation

### üìã **Development Environment**

For contributors and developers:

- **Development mode**: Uses `docker-compose.dev.yml` with hot-reload
- **Production mode**: Uses main `docker-compose.yml` with optimized builds
- **Local development**: Full instructions for non-Docker setup
- **Database migrations**: Handled automatically via init.sql and manual commands

---

## üìÑ License

This project is provided as-is for demonstration purposes. Feel free to explore, learn, and adapt the codebase for your own projects. 